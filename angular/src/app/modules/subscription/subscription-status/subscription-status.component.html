<div *ngIf="subscriptionData$ | async as data; else loadingOrError">
  <div *ngIf="!data.isLoading && data.subscription; else loadingOrError">
    <h2>Subscription Status</h2>
    <p><strong>Status:</strong> {{ data.subscription.status }}</p>
    <p><strong>Plan:</strong> {{ data.subscription.plan || 'N/A' }}</p>
    <p *ngIf="data.subscription.currentPeriodEnd">
      <strong>Current Period End:</strong> {{ data.subscription.currentPeriodEnd | date:'medium' }}
    </p>
    <p *ngIf="data.subscription.cancelAtPeriodEnd">
      Subscription will cancel at the end of the current period.
    </p>
    <!-- Add more details as needed -->
  </div>
</div>

<ng-template #loadingOrError>
  <!-- Check loading state from the observable -->
  <div *ngIf="(subscriptionData$ | async)?.isLoading">
    <p>Loading subscription status...</p>
  </div>
  <!-- Handle case where subscription is null after loading -->
  <div *ngIf="!(subscriptionData$ | async)?.isLoading && !(subscriptionData$ | async)?.subscription">
    <p>Could not load subscription details or no active subscription found.</p>
  </div>
</ng-template>
